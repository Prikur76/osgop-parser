from app.services.parser import OSGOPParser


SAMPLE_TEXT = """
ПОЛИС ОБЯЗАТЕЛЬНОГО СТРАХОВАНИЯ ГРАЖДАНСКОЙ ОТВЕТСТВЕННОСТИ
ПЕРЕВОЗЧИКА ЗА ПРИЧИНЕНИЕ ВРЕДА ЖИЗНИ, ЗДОРОВЬЮ, ИМУЩЕСТВУ
ПАССАЖИРОВ ПРИ ПЕРЕВОЗКАХ АВТОМОБИЛЬНЫМ ТРАНСПОРТОМ
№ ROSX22511271355000
Срок страхования: с «31» октября 2025 г. по «30» октября 2026 г.
Страховщик: Акционерное общество «Зетта Страхование» (АО «ЗЕТТА СТРАХОВАНИЕ»), Лицензия ЦБ РФОС№ 290 – 05 от 06.06.2023 г.
ИНН/КПП: 7702073683/770501001
Страхователь: Общество с ограниченной ответственностью «ТрансАвто»
ИНН / КПП: 9718074750/771801001
"""


def test_header_extraction():
    p = OSGOPParser()
    data = p._parse_polis_header(SAMPLE_TEXT)

    assert data["contract_number"] == "ROSX22511271355000"
    assert data["insurer"] == "Акционерное общество Зетта Страхование"
    assert data["insured"] == 'Общество с ограниченной ответственностью ТрансАвто'
    assert data["insurer_inn"] == "7702073683"
    assert data["insured_inn"] == "9718074750"
