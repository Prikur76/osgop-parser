import re


# Извлечение номера ОСГОП
RE_ROSX = re.compile(r"№\s*(ROSX\d+)", re.I)

# Регулярки для поиска границ документов
RE_POLIS_START = re.compile(r"ПОЛИС\s+ОБЯЗАТЕЛЬНОГО\s+СТРАХОВАНИЯ", re.I)
RE_SVEDENIYA_START = re.compile(r"СВЕДЕНИЯ\s+О\s+ДОГОВОРЕ", re.I)

# Извлечение госномера
RE_PLATE = re.compile(r"\b(?:[А-ЯA-Z]\d{3}[А-ЯA-Z]{2}\d{2,3}|[А-ЯA-Z]{2}\d{5,6})\b")

# Извлечение периода "с ... по ..."
RE_PERIOD_EXPLICIT = re.compile(
    r"с\s*«?(\d{1,2})»?\s+([А-Яа-яё]+)\s+(\d{4}).{0,80}?по\s*«?(\d{1,2})»?\s+([А-Яа-яё]+)\s+(\d{4})",
    re.I | re.S
)

# Извлечение дат в формате '01 января 2025 года'
RE_DATE_ANY = re.compile(r"(\d{1,2})\s+([А-Яа-яё]+)\s+(\d{4})", re.I)

# Регулярка для ИНН (учитывает формат "ИНН/КПП:" и "ИНН :")
RE_INN = re.compile(r"ИНН[:\s/]*(\d{10,12})", re.I)
RE_INN_KPP = re.compile(r"ИНН\s*/?\s*КПП[:\s]*(\d{10,12})[^\d]*(\d{9})?", re.I)

# Регулярка для страховой премии (учитывает "Итого страховая премия:")
RE_PREMIUM = re.compile(
    r"(?:страхов(ая|ой)\s+преми[ия]|Итого\s+страховая\s+премия)[\s:]*(\d[\d\s.,]+)",
    re.I
)

# Регулярки для извлечения страховщика
RE_INSURER = re.compile(r"Страховщик\s*[:;]?\s*(.*?)(?=\s*ИНН|$|Лицензия|Страхователь)", re.I | re.S)
RE_INSURER_FULL = re.compile(r"Страховщик\s*[:;]?\s*(.*?)(?=\s*Страхователь|$)", re.I | re.S)
RE_INSURED = re.compile(r"Страхователь\s*[;:]\s*(.*?)(?=\s*(?:ИНН|Перевозчик|$))", re.I | re.S)
